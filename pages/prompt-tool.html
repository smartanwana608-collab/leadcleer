<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Prompt Tool | Leadcleer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Global CSS -->
  <link rel="stylesheet" href="../assets/css/main.css" />
</head>

<body>

<!-- ===============================
NAV
================================ -->
<header class="nav">
  <div class="nav-container">
    <div class="logo">Leadcleer</div>
    <nav class="nav-links">
      <a href="../index.html">Home</a>
      <a href="../features.html" class="active">Features</a>
      <a href="../pricing.html">Pricing</a>
      <a href="../how-it-works.html">How It Works</a>
      <a href="../contact.html">Contact</a>
    </nav>
  </div>
</header>

<!-- ===============================
PROMPT TOOL
================================ -->
<main class="tool-container">

  <!-- HEADER -->
  <header class="tool-header">
    <h1>Prompt Tool</h1>
    <p class="tool-subtitle">
      Type what you want to do with your CSV.  
      Leadcleer will match it to the closest available action.
    </p>
  </header>

  <!-- STEP 1: UPLOAD CSV -->
  <section class="tool-step">
    <div class="tool-card">
      <h2 class="step-title">1. Upload CSV</h2>

      <input type="file" id="csvFile" accept=".csv" />
      <p class="upload-hint">Your file stays in your browser.</p>
    </div>
  </section>

  <!-- STEP 2: PROMPT -->
  <section class="tool-step">
    <div class="tool-card">
      <h2 class="step-title">2. Enter Prompt</h2>

      <textarea
        id="promptInput"
        rows="3"
        placeholder="e.g. filter real estate agents"
      ></textarea>

      <button id="runPromptBtn" class="btn primary" disabled>
        Run Prompt
      </button>
    </div>
  </section>

  <!-- STEP 3: AVAILABLE ACTIONS (STATIC FOR NOW) -->
  <section class="tool-step">
    <div class="tool-card">
      <h2 class="step-title">Available Actions</h2>

      <ul class="action-list">
        <li>filter real estate</li>
        <li>remove duplicates</li>
        <li>remove missing emails</li>
      </ul>

      <p class="muted-text">
        Tip: copy an action name if you're unsure what to type.
      </p>
    </div>
  </section>

  <!-- STEP 4: RESULTS -->
  <section class="tool-step" id="promptResults" style="display:none;"></section>

</main>

<!-- ===============================
FOOTER
================================ -->
<footer class="footer">
  <div class="footer-container">
    <div class="footer-brand">
      <div class="footer-logo">
        <span class="logo-dot"></span>
        <span class="logo-text">Leadcleer</span>
      </div>
      <p class="footer-tagline">
        Clean data. Better decisions.
      </p>
    </div>
  </div>

  <div class="footer-bottom">
    Â© 2026 Leadcleer. All rights reserved.
  </div>
</footer>

<!-- ===============================
SCRIPT (CSV â†’ Prompt Engine Bridge)
================================ -->
<script type="module">
  import "../assets/js/prompt-engine.js";

  const csvInput = document.getElementById("csvFile");
  const runBtn = document.getElementById("runPromptBtn");

  runBtn.disabled = true;

  csvInput.addEventListener("change", e => {
    const reader = new FileReader();

    reader.onload = () => {
      const lines = reader.result.split("\n").filter(Boolean);
      const headers = lines[0].split(",");

      const rows = lines.slice(1).map(line => {
        const values = line.split(",");
        const obj = {};
        headers.forEach((h, i) => {
          obj[h.trim()] = values[i]?.trim() || "";
        });
        return obj;
      });

      // ðŸ”¥ CRITICAL EVENT
      document.dispatchEvent(
        new CustomEvent("csvParsed", {
          detail: { rows }
        })
      );

      runBtn.disabled = false;
    };

    reader.readAsText(e.target.files[0]);
  });
</script>

</body>
</html>
